<!DOCTYPE html>
<html>
<head>
  <title>Boreholeguyz Invoice</title>
  <style>
    /* ... (CSS from the original code, plus any additions for better invoice styling) ... */
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <img src="images/Boreholeguys.png" alt="Boreholeguyz Logo" class="logo">
      <h1>Boreholeguyz Invoice</h1>
    </div>
    <div id="invoiceContent"></div>

    <button type="button" id="generateInvoicePdfButton" onclick="generatePdfAndShare()">Generate PDF & Download</button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script>
      function getParameter(param) {
          const urlParams = new URLSearchParams(window.location.search);
          return urlParams.get(param);
      }
      const quoteNumber = getParameter('quoteNumber');
      const invoiceDate = getParameter('invoiceDate');
      const customerName = getParameter('customerName');
      const customerAddress = getParameter('customerAddress');
      const items = JSON.parse(getParameter('items'));

      function createInvoiceContent(data){
        const invoiceHTML = `
        <div class="customer-info">
          <p><strong>Quote #:</strong> ${data.quoteNumber}</p>
          <p><strong>Date:</strong> ${data.invoiceDate}</p>
          <p><strong>Customer Name:</strong> ${data.customerName}</p>
          <p><strong>Customer Address:</strong> ${data.customerAddress}</p>
        </div>
        <table>
          <thead>
            <tr>
              <th>QTY</th>
              <th>DESCRIPTION</th>
              <th>UNIT PRICE</th>
              <th>TOTAL</th>
            </tr>
          </thead>
          <tbody>
            ${data.items.map(item => `<tr><td>${item.quantity}</td><td>${item.description}</td><td>${item.unitPrice.toFixed(2)}</td><td>${(item.quantity * item.unitPrice).toFixed(2)}</td></tr>`).join('')}
          </tbody>
          <tfoot>
            <tr>
              <td colspan="3" class="total">Subtotal:</td>
              <td class="total" id="subTotal">${data.items.reduce((sum, item) => sum + item.quantity * item.unitPrice, 0).toFixed(2)}</td>
            </tr>
            <tr>
              <td colspan="3" class="total">VAT (15%):</td>
              <td class="total" id="vatTotal">${(data.items.reduce((sum, item) => sum + item.quantity * item.unitPrice, 0) * 0.15).toFixed(2)}</td>
            </tr>
            <tr>
              <td colspan="3" class="total">Grand Total:</td>
              <td class="total" id="grandTotal">${(data.items.reduce((sum, item) => sum + item.quantity * item.unitPrice, 0) * 1.15).toFixed(2)}</td>
            </tr>
          </tfoot>
        </table>`;
        document.getElementById('invoiceContent').innerHTML = invoiceHTML;

      }
      createInvoiceContent({quoteNumber, invoiceDate, customerName, customerAddress, items});


      function generatePdfAndShare() {
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF();

        // ... (generatePdfAndShare function from original code, adapted to get data from the dynamically created invoiceContent) ...  You will need to modify this to extract data from the dynamically created elements in #invoiceContent.
      }
    </script>
  </div>
</body>
</html>
